<!DOCTYPE html>
<!--suppress CssUnusedSymbol, CssRedundantUnit, JSUnusedLocalSymbols, JSUnusedGlobalSymbols, JSValidateTypes, JSUnresolvedVariable, JSUnresolvedFunction, ES6ConvertVarToLetConst, JSUnusedAssignment, JSUnresolvedLibraryURL, JSUnreachableCode, JSUnnecessarySemicolon, JSUnusedLabel, JSCommaExpression, JSUnresolvedReference, JSBitwiseOperatorUsage -->
<html lang="en">

<head>
  <!--suppress CssUnusedSymbol, CssRedundantUnit, JSUnusedLocalSymbols, JSUnusedGlobalSymbols, JSValidateTypes, JSUnresolvedVariable, JSUnresolvedFunction, ES6ConvertVarToLetConst, JSUnusedAssignment, JSUnresolvedLibraryURL, JSUnreachableCode, JSUnnecessarySemicolon, JSUnusedLabel, JSCommaExpression, JSUnresolvedReference, JSBitwiseOperatorUsage -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iq</title>
  <style>
    :root {
      --control-height: 2.6em;
      --control-font-size: 0.95em;
      --search-gap: 0.25em;
      /* default small gap between buttons */
      --search-gap-large: 0.5em;
      /* larger gap between groups */
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
      color: #222;
    }

    .top-controls {
      display: flex;
      align-items: center;
      gap: 0.5em;
      margin-bottom: 0.3em;
    }

    .top-controls .tabs-toggle {
      margin-bottom: 0;
      /* row handles spacing */
      flex: 1 1 auto;
    }

    .theme-toggle {
      height: var(--control-height);
      padding: 0 0.8em;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #fff;
      color: #222;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      flex: 0 0 auto;
    }

    .theme-toggle:hover {
      border-color: #0077cc;
    }

    /* Quiz link – same style as quiz.html "Browse questions" button */
    .top-controls .quiz-link-btn {
      flex: 0 0 auto;
      height: var(--control-height);
      font-size: var(--control-font-size);
      padding: 0 0.8em;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #fff;
      color: #222;
      font-weight: bold;
      display: inline-flex;
      align-items: center;
      text-decoration: none;
      box-sizing: border-box;
      transition: border-color 0.2s, background 0.2s;
    }
    .top-controls .quiz-link-btn:hover {
      border-color: #0077cc;
      background: #f0f8ff;
    }
    body.dark .top-controls .quiz-link-btn {
      background: #171a21;
      color: #e7eaf0;
      border-color: #2a3142;
    }
    body.dark .top-controls .quiz-link-btn:hover {
      border-color: #5db0ff;
      background: #1d2431;
    }

    /* Dark mode overrides */
    body.dark {
      background: #0f1115;
      color: #e7eaf0;
    }

    body.dark .search-box,
    body.dark .search-action-btn,
    body.dark #questionCounter,
    body.dark .tabs-toggle,
    body.dark .keyboard-btn,
    body.dark .alphabet-nav-btn,
    body.dark .theme-toggle {
      background: #171a21;
      color: #e7eaf0;
      border-color: #2a3142;
    }

    body.dark .search-action-btn:hover,
    body.dark .tabs-toggle:hover,
    body.dark .keyboard-btn:hover,
    body.dark .alphabet-nav-btn:hover,
    body.dark .theme-toggle:hover {
      border-color: #5db0ff;
      background: #1d2431;
      color: #e7eaf0;
    }

    body.dark .question-item {
      background: #171a21;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.35);
    }

    body.dark .question-btn {
      color: #e7eaf0;
    }

    body.dark .question-btn:hover {
      background: #202633;
    }

    body.dark .spoiler {
      background: #141822;
      border-top-color: #232a3a;
      color: #e7eaf0;
    }
    body.dark .spoiler ul, body.dark .spoiler ol { color: #e7eaf0; }

    body.dark .spoiler code {
      background: #202633;
      color: #e7eaf0;
    }

    body.dark .tab-btn {
      background: #202633;
      color: #e7eaf0;
    }

    body.dark .tab-btn.active {
      background: #171a21;
      border-bottom-color: #5db0ff;
      color: #5db0ff;
    }

    body.dark .main-tab.expanded {
      background: #1d2431;
      color: #5db0ff;
    }

    body.dark .subtab-btn {
      background: #202633;
      color: #b6bdc9;
    }

    body.dark .subtab-btn:hover {
      background: #1d2431;
    }

    body.dark .subtab-btn.active {
      background: #171a21;
      border-bottom-color: #5db0ff;
      color: #5db0ff;
    }

    #extraTabContent {
      background: #fff;
      color: #222;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03);
      margin-bottom: 0.5em;
      padding: 1em;
      display: none;
    }

    body.dark #extraTabContent {
      background: #171a21;
      color: #e7eaf0;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.35);
    }

    .container {
      max-width: 700px;
      margin: auto;
      padding: 0.5em;
    }

    .search-box,
    .search-action-btn {
      height: var(--control-height);
      font-size: var(--control-font-size);
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      color: #222;
      box-sizing: border-box;
      transition: border-color 0.2s, box-shadow 0.2s;
      padding: 0 0.8em;
      margin-bottom: 0;
      display: flex;
      align-items: center;
    }

    .search-row {
      display: flex;
      align-items: center;
      gap: var(--search-gap);
      width: 100%;
      margin-bottom: 0.5em;
    }

    #questionCounter {
      height: var(--control-height);
      font-size: var(--control-font-size);
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      color: #222;
      box-sizing: border-box;
      padding: 0 0.8em;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      min-width: 3.5em;
      white-space: nowrap;
      flex: 0 0 auto;
    }

    .search-box {
      flex: 1 1 auto;
      min-width: 0;
      margin-bottom: 0;
    }

    .search-action-btn {
      flex: 0 0 auto;
      cursor: pointer;
      min-width: 2.6em;
      justify-content: center;
      font-weight: bold;
      border: 1px solid #ccc;
      background: #fff;
      margin-left: 0;
      /* spacing handled by .search-row gap */
    }

    .search-action-btn:hover {
      border-color: #0077cc;
      background: #f0f8ff;
      color: #0077cc;
    }

    .question-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .question-item {
      background: #fff;
      margin-bottom: 0.4em;
      border-radius: 4px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03);
      overflow: hidden;
      transition: box-shadow 0.2s;
    }

    .question-btn {
      width: 100%;
      text-align: left;
      background: none;
      border: none;
      padding: 0.7em;
      font-size: 0.98em;
      cursor: pointer;
      outline: none;
      color: #222;
      font-weight: bold;
      transition: background 0.2s;
    }

    .question-btn:hover {
      background: #f0f0f0;
    }

    .spoiler {
      display: none;
      padding: 0.7em;
      background: #f6f6f6;
      border-top: 1px solid #eee;
      font-size: 0.95em;
    }

    .spoiler ul,
    .spoiler ol {
      margin: 0.5em 0;
      padding-left: 1.5em;
    }
    .spoiler ul { list-style-type: disc; }
    .spoiler ol { list-style-type: decimal; }
    .spoiler li {
      margin: 0.35em 0;
      line-height: 1.4;
    }

    .spoiler code {
      background: #eaeaea;
      padding: 2px 4px;
      border-radius: 4px;
      font-size: 0.95em;
      display: block;
      margin: 0.3em 0;
      white-space: pre-wrap;
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5em;
      margin-bottom: 0.5em;
      max-height: 500px;
      overflow-y: auto;
      overflow-x: hidden;
      transition: max-height 0.3s ease-out, margin-bottom 0.3s ease-out;
    }

    .tabs.collapsed {
      max-height: 0;
      margin-bottom: 0;
    }

    .tabs-toggle {
      display: flex;
      width: 100%;
      height: 2.6em;
      font-size: 0.95em;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      color: #222;
      cursor: pointer;
      font-weight: bold;
      padding: 0 0.8em;
      margin-bottom: 0.3em;
      align-items: center;
      justify-content: space-between;
      transition: border-color 0.2s, background 0.2s;
    }

    .tabs-toggle:hover {
      border-color: #0077cc;
      background: #f0f8ff;
    }

    .tabs-toggle-icon {
      transition: transform 0.3s;
    }

    .tabs-toggle.collapsed .tabs-toggle-icon {
      transform: rotate(-90deg);
    }

    .tab-btn {
      flex: 0 1 calc(20% - 0.4em);
      min-width: 100px;
      padding: 0.5em;
      font-size: 1em;
      border: none;
      background: #eee;
      cursor: pointer;
      border-radius: 6px 6px 0 0;
      font-weight: bold;
    }

    .tab-btn.active {
      background: #fff;
      border-bottom: 2px solid #0077cc;
      color: #0077cc;
    }

    /* Main tabs that expand */
    .main-tab {
      position: relative;
    }

    .main-tab.expanded {
      background: #ddd;
      color: #0077cc;
    }

    /* Subtabs container */
    .subtabs {
      display: none;
      gap: 0.5em;
      padding: 0;
      background: transparent;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out, margin-bottom 0.3s ease-out;
      margin-bottom: 0;
    }

    .subtabs.expanded {
      display: flex;
      max-height: 100px;
      margin-bottom: 0.5em;
    }

    .subtab-btn {
      flex: 1;
      padding: 0.5em;
      font-size: 1em;
      border: none;
      background: #e8e8e8;
      cursor: pointer;
      border-radius: 6px 6px 0 0;
      font-weight: bold;
      transition: all 0.3s ease;
      color: #666;
    }

    .subtab-btn:hover {
      background: #ddd;
    }

    .subtab-btn.active {
      background: #fff;
      border-bottom: 2px solid #0077cc;
      color: #0077cc;
    }


    .keyboard-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.2em;
      justify-content: center;
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height 0.3s ease-out, opacity 0.3s ease-out, margin-bottom 0.3s ease-out;
      margin-bottom: 0;
    }

    .keyboard-row.visible {
      max-height: 200px;
      opacity: 1;
      margin-bottom: 0.5em;
    }

    .keyboard-btn {
      height: 2em;
      min-width: 1.8em;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      color: #222;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: border-color 0.2s, background 0.2s, color 0.2s;
    }

    .keyboard-btn.space {
      min-width: 3.5em;
    }

    .keyboard-btn.delete {
      min-width: 2.5em;
      color: #c00;
    }

    .keyboard-btn:hover {
      border-color: #0077cc;
      background: #f0f8ff;
      color: #0077cc;
    }

    /* Content wrapper with alphabet nav */
    .content-wrapper {
      display: flex;
      gap: 1em;
      align-items: flex-start;
    }

    .alphabet-nav {
      position: sticky;
      top: 10px;
      display: flex;
      flex-direction: column;
      gap: 0.2em;
      min-width: 30px;
      flex-shrink: 0;
      order: 2;
    }

    .alphabet-nav-btn {
      width: 30px;
      height: 30px;
      padding: 0;
      font-size: 0.85em;
      font-weight: bold;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: #fff;
      color: #222;
      cursor: pointer;
      transition: all 0.2s;
    }

    .alphabet-nav-btn:hover {
      border-color: #0077cc;
      background: #f0f8ff;
      color: #0077cc;
    }

    .questions-wrapper {
      flex: 1;
      min-width: 0;
      order: 1;
    }

    /* Code block styling */
    .spoiler pre {
      background: #2d2d2d;
      border-radius: 8px;
      padding: 1em;
      overflow-x: auto;
      margin: 1em 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .spoiler code {
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
      font-size: 0.85em !important;
      line-height: 1.5;
    }

    .spoiler pre code {
      background: none;
      padding: 0;
      border: none;
      display: block;
    }

    /* Override Prism theme for better visibility */
    pre[class*="language-"] {
      margin: 1em 0;
      background: #2d2d2d !important;
      font-size: 0.85em !important;
    }

    code[class*="language-"] {
      color: #ccc;
      text-shadow: none;
      font-size: 0.85em !important;
    }


    @media (max-width: 600px) {
      .container {
        padding: 0.2em;
      }

      .question-btn,
      .spoiler {
        font-size: 0.95em;
        padding: 0.5em;
      }

      .tabs {
        gap: 0.2em;
        max-height: 60vh;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }

      .tab-btn {
        font-size: 0.95em;
        padding: 0.3em;
        flex: 1 1 calc(50% - 0.2em);
        min-width: 0;
      }

      /* Adjust tabs toggle button size for mobile */
      .tabs-toggle {
        height: 2em;
        font-size: 1em;
        padding: 0 0.5em;
      }

      .theme-toggle {
        height: 2em;
        font-size: 1em;
        padding: 0 0.6em;
      }

      /* Hide keyboard on mobile */
      .keyboard-row {
        display: none;
      }

      /* Fit all search row elements on one line */
      .search-row {
        flex-wrap: nowrap;
        gap: 0.15em;
      }

      .search-box {
        flex: 1 1 auto;
        min-width: 0;
        font-size: 1em;
        height: 2em;
        padding: 0 0.5em;
      }

      #questionCounter {
        font-size: 1em;
        min-width: 2.5em;
        height: 2em;
        padding: 0 0.4em;
      }

      .search-action-btn {
        font-size: 1em;
        min-width: 2em;
        height: 2em;
        padding: 0 0.3em;
        margin-left: 0 !important;
      }


      /* Keep alphabet nav on the right on mobile */
      .alphabet-nav {
        max-height: 70vh;
        overflow-y: auto;
        overflow-x: hidden;
        position: sticky;
        top: 10px;
      }

      .alphabet-nav::-webkit-scrollbar {
        width: 3px;
      }

      .alphabet-nav::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      .alphabet-nav::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 3px;
      }

      .alphabet-nav::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
    }
  </style>

  <!-- Prism.js for syntax highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
</head>

<body>
  <div class="container">
    <div class="top-controls">
      <button class="tabs-toggle collapsed" id="tabsToggle" type="button">
        <span id="tabsToggleText">Tabs</span>
        <span class="tabs-toggle-icon">▼</span>
      </button>
      <a href="quiz.html" class="quiz-link-btn">Quiz</a>
      <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle dark mode">Dark</button>
    </div>

    <!-- Main tabs row -->
    <div class="tabs collapsed" id="tabsContainer">
      <button id="mainJava" class="tab-btn main-tab">Java</button>
      <button id="mainJS" class="tab-btn main-tab">JavaScript</button>
      <button id="mainTS" class="tab-btn main-tab">TypeScript</button>
      <button id="mainCypress" class="tab-btn main-tab">Cypress</button>
      <button id="tabPrinciples" class="tab-btn">Principles</button>
      <button id="tabQA" class="tab-btn">QA</button>
      <button id="tabAutomation" class="tab-btn">Automation</button>
      <button id="mainMisc" class="tab-btn main-tab">Misc</button>
      <button id="tabCultural" class="tab-btn">Cultural</button>
      <button id="tabCurrent" class="tab-btn">Current</button>
    </div>

    <!-- Expandable subtabs (hidden by default) -->
    <div class="subtabs" id="subtabsJava">
      <button id="tabTheory" class="subtab-btn">Theory</button>
      <button id="tabPractice" class="subtab-btn">Practice</button>
    </div>
    <div class="subtabs" id="subtabsJS">
      <button id="tabJSTheory" class="subtab-btn">Theory</button>
      <button id="tabJSPractice" class="subtab-btn">Practice</button>
    </div>
    <div class="subtabs" id="subtabsTS">
      <button id="tabTSTheory" class="subtab-btn">Theory</button>
      <button id="tabTSPractice" class="subtab-btn">Practice</button>
    </div>
    <div class="subtabs" id="subtabsCypress">
      <button id="tabCypressTheory" class="subtab-btn">Theory</button>
      <button id="tabCypressPractice" class="subtab-btn">Practice</button>
    </div>
    <div class="subtabs" id="subtabsMisc">
      <button id="tabMiscDatabases" class="subtab-btn">Databases</button>
      <button id="tabMiscGit" class="subtab-btn">Git</button>
      <button id="tabMiscNetwork" class="subtab-btn">Network</button>
      <button id="tabMiscContainers" class="subtab-btn">Containers</button>
      <button id="tabMiscGeneral" class="subtab-btn">General</button>
    </div>
    <label for="searchBox" style="position:absolute;left:-9999px;">Search questions</label>
    <div class="search-row">
      <span id="questionCounter">0</span>
      <input type="text" class="search-box" id="searchBox" placeholder="Search questions..." />
      <button id="clearSearchBtn" class="search-action-btn" title="Clear search">&#x2716;</button>
      <button id="globalSearchBtn" class="search-action-btn" title="Search all tabs">&#x1F310;</button>
      <button id="filterHighBtn" class="search-action-btn" title="Filter high priority"
        style="color: #ffb3b3;">&#x25B2;</button>
      <button id="filterMediumBtn" class="search-action-btn" title="Filter medium priority"
        style="color: #ffe066;">&#x25A0;</button>
      <button id="filterLowBtn" class="search-action-btn" title="Filter low priority"
        style="color: #d9d9d9;">&#x25BC;</button>
      <button id="collapseAllBtn" class="search-action-btn" title="Collapse all">[-]</button>
    </div>
    <div class="keyboard-row" id="keyboardRow"></div>
    <div class="content-wrapper">
      <div class="alphabet-nav" id="alphabetNav"></div>
      <div class="questions-wrapper">
        <ul class="question-list" id="questionList"></ul>
      </div>
    </div>
    <div id="extraTabContent"></div>
  </div>

  <!-- Import all question files -->
  <script src="questions/culturalQuestions.js"></script>
  <script src="questions/currentQuestions.js"></script>
  <script src="questions/java/theoryQuestions.js"></script>
  <script src="questions/java/practiceQuestions.js"></script>
  <script src="questions/js/theoryQuestions.js"></script>
  <script src="questions/js/practiceQuestions.js"></script>
  <script src="questions/ts/theoryQuestions.js"></script>
  <script src="questions/ts/practiceQuestions.js"></script>
  <script src="questions/cypress/theoryQuestions.js"></script>
  <script src="questions/cypress/practiceQuestions.js"></script>
  <script src="questions/automationQuestions.js"></script>
  <script src="questions/qaQuestions.js"></script>
  <script src="questions/principlesQuestions.js"></script>
  <script src="questions/misc/databasesQuestions.js"></script>
  <script src="questions/misc/gitQuestions.js"></script>
  <script src="questions/misc/networkQuestions.js"></script>
  <script src="questions/misc/containersQuestions.js"></script>
  <script src="questions/misc/generalQuestions.js"></script>
  <script>
    // Main application script

    function applyTheme(mode) {
      document.body.classList.toggle('dark', mode === 'dark');
      const btn = document.getElementById('themeToggle');
      if (btn) btn.textContent = mode === 'dark' ? 'Light' : 'Dark';
    }

    function initTheme() {
      const saved = localStorage.getItem('theme');
      if (saved === 'dark' || saved === 'light') {
        applyTheme(saved);
        return;
      }
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      applyTheme(prefersDark ? 'dark' : 'light');
    }

    // Small debounce helper to avoid expensive renders on each keystroke
    function debounce(fn, wait) {
      let t = null;
      return function (...args) {
        clearTimeout(t);
        t = setTimeout(() => fn.apply(this, args), wait);
      };
    }

    // Global state variables
    let activeTab = 'tabTheory';
    let activeMainTab = 'mainJava'; // Track which main tab is expanded
    let isGlobalSearch = false;
    let activePriorityFilter = null;

    const tabMap = {
      tabTheory: javaTheoryQuestions,
      tabPractice: javaPracticeQuestions,
      tabCypressTheory: cypressTheoryQuestions,
      tabCypressPractice: cypressPracticeQuestions,
      tabPrinciples: principlesQuestions,
      tabQA: qaQuestions,
      tabAutomation: automationQuestions,
      tabJSTheory: jsTheoryQuestions,
      tabJSPractice: jsPracticeQuestions,
      tabTSTheory: tsTheoryQuestions,
      tabTSPractice: tsPracticeQuestions,
      tabMiscDatabases: miscDatabasesQuestions,
      tabMiscGit: miscGitQuestions,
      tabMiscNetwork: miscNetworkQuestions,
      tabMiscContainers: miscContainersQuestions,
      tabMiscGeneral: miscGeneralQuestions,
      tabCultural: culturalQuestions,
      tabCurrent: currentQuestions
    };

    // Expand/collapse main tabs and show subtabs
    function toggleMainTab(mainTabId) {
      const mainTab = document.getElementById(mainTabId);
      const subtabsMap = {
        'mainJava': 'subtabsJava',
        'mainJS': 'subtabsJS',
        'mainTS': 'subtabsTS',
        'mainCypress': 'subtabsCypress',
        'mainMisc': 'subtabsMisc'
      };

      const subtabsId = subtabsMap[mainTabId];
      if (!subtabsId) return;

      const subtabsContainer = document.getElementById(subtabsId);

      // Check if already expanded
      const isExpanded = mainTab.classList.contains('expanded');

      // Collapse all main tabs and subtabs first
      document.querySelectorAll('.main-tab').forEach(tab => tab.classList.remove('expanded'));
      document.querySelectorAll('.subtabs').forEach(sub => {
        sub.classList.remove('expanded');
      });

      if (!isExpanded) {
        // Expand this main tab
        mainTab.classList.add('expanded');
        subtabsContainer.classList.add('expanded');
        activeMainTab = mainTabId;

        // Auto-select first subtab (Theory)
        const firstSubtab = subtabsContainer.querySelector('.subtab-btn');
        if (firstSubtab) {
          firstSubtab.click();
        }
      }
    }

    function setActiveTab(tabId) {
      // Remove active class from all regular tabs and subtabs
      document.querySelectorAll('.tab-btn:not(.main-tab)').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.subtab-btn').forEach(btn => btn.classList.remove('active'));

      // Add active class to clicked tab
      const activeBtn = document.getElementById(tabId);
      if (activeBtn) activeBtn.classList.add('active');
    }

    function showTab(tabId) {
      activeTab = tabId;

      // Turn off global search when switching to a specific tab
      if (isGlobalSearch) {
        isGlobalSearch = false;
        if (typeof updateGlobalSearchButtonStyle === 'function') updateGlobalSearchButtonStyle();
        const searchBox = document.getElementById('searchBox');
        if (searchBox) {
          searchBox.placeholder = 'Search questions...';
        }
      }

      setActiveTab(tabId);
      document.getElementById('questionList').style.display = '';
      document.getElementById('extraTabContent').style.display = 'none';
      renderQuestions(document.getElementById('searchBox').value);

      // Update toggle button text with breadcrumb (Parent > Subtab)
      const tabsToggleText = document.getElementById('tabsToggleText');
      if (tabsToggleText) {
        let breadcrumb = '';

        // Determine if this is a subtab and build breadcrumb
        if (tabId === 'tabTheory' || tabId === 'tabPractice') {
          breadcrumb = 'Java > ' + (tabId === 'tabTheory' ? 'Theory' : 'Practice');
        } else if (tabId === 'tabJSTheory' || tabId === 'tabJSPractice') {
          breadcrumb = 'JavaScript > ' + (tabId === 'tabJSTheory' ? 'Theory' : 'Practice');
        } else if (tabId === 'tabTSTheory' || tabId === 'tabTSPractice') {
          breadcrumb = 'TypeScript > ' + (tabId === 'tabTSTheory' ? 'Theory' : 'Practice');
        } else if (tabId === 'tabCypressTheory' || tabId === 'tabCypressPractice') {
          breadcrumb = 'Cypress > ' + (tabId === 'tabCypressTheory' ? 'Theory' : 'Practice');
        } else if (tabId === 'tabMiscDatabases' || tabId === 'tabMiscGit' || tabId === 'tabMiscNetwork' || tabId === 'tabMiscContainers' || tabId === 'tabMiscGeneral') {
          const miscSubNames = { tabMiscDatabases: 'Databases', tabMiscGit: 'Git', tabMiscNetwork: 'Network', tabMiscContainers: 'Containers', tabMiscGeneral: 'General' };
          breadcrumb = 'Misc > ' + (miscSubNames[tabId] || '');
        } else {
          // Simple tab - just show the tab name
          const tabNames = {
            'tabPrinciples': 'Principles',
            'tabQA': 'QA',
            'tabAutomation': 'Automation',
            'tabCultural': 'Cultural',
            'tabCurrent': 'Current'
          };
          breadcrumb = tabNames[tabId] || 'Tabs';
        }

        tabsToggleText.textContent = breadcrumb;
      }

      // Hide all subtabs when clicking simple tabs (non-expandable tabs)
      const simpleTabIds = ['tabPrinciples', 'tabQA', 'tabAutomation', 'tabCultural', 'tabCurrent'];
      if (simpleTabIds.includes(tabId)) {
        // Collapse all main tabs
        document.querySelectorAll('.main-tab').forEach(tab => tab.classList.remove('expanded'));
        // Hide all subtabs
        document.querySelectorAll('.subtabs').forEach(sub => {
          sub.classList.remove('expanded');
        });
      }

      // Auto-collapse tabs after selection
      const tabsToggle = document.getElementById('tabsToggle');
      const tabsContainer = document.getElementById('tabsContainer');
      if (tabsToggle && tabsContainer) {
        tabsToggle.classList.add('collapsed');
        tabsContainer.classList.add('collapsed');
      }
    }

    function renderQuestions(filter = '') {
      const list = document.getElementById('questionList');
      list.innerHTML = '';

      // Get questions - either from current tab or all tabs (global search)
      let questionsToShow = isGlobalSearch
        ? getAllQuestionsFromAllTabs()
        : (tabMap[activeTab] || []);

      if (questionsToShow.length && questionsToShow[0].q) {
        questionsToShow = [...questionsToShow].sort((a, b) => a.q.localeCompare(b.q));
      }

      // Apply text filter
      if (filter.trim()) {
        questionsToShow = questionsToShow.filter(q => q.q && q.q.toLowerCase().includes(filter.toLowerCase()));
      }

      // Apply priority filter
      if (activePriorityFilter) {
        questionsToShow = questionsToShow.filter(q => q.priority === activePriorityFilter);
      }

      questionsToShow.forEach((qObj, idx) => {
        list.appendChild(createQuestionItem(qObj, idx));
      });

      // Update question counter
      const counter = document.getElementById('questionCounter');
      if (counter) {
        counter.textContent = questionsToShow.length;
      }

      // Render alphabet navigation after rendering questions
      renderAlphabetNav(questionsToShow);
    }

    function getAllQuestionsFromAllTabs() {
      const allQuestions = [];
      const tabNames = {
        'tabTheory': 'Java Theory',
        'tabPractice': 'Java Practice',
        'tabPrinciples': 'Principles',
        'tabJSTheory': 'JS Theory',
        'tabJSPractice': 'JS Practice',
        'tabTSTheory': 'TS Theory',
        'tabTSPractice': 'TS Practice',
        'tabCypressTheory': 'Cypress Theory',
        'tabCypressPractice': 'Cypress Practice',
        'tabQA': 'QA',
        'tabAutomation': 'Automation',
        'tabMiscDatabases': 'Misc Databases',
        'tabMiscGit': 'Misc Git',
        'tabMiscNetwork': 'Misc Network',
        'tabMiscContainers': 'Misc Containers',
        'tabMiscGeneral': 'Misc General',
        'tabCultural': 'Cultural',
        'tabCurrent': 'Current'
      };

      Object.keys(tabMap).forEach(tabKey => {
        const questions = tabMap[tabKey] || [];
        questions.forEach(q => {
          allQuestions.push({
            ...q,
            sourceTab: tabKey,
            sourceTabName: tabNames[tabKey] || tabKey
          });
        });
      });

      return allQuestions;
    }

    // Render alphabet navigation based on provided questions array (makes it global-search aware)
    function renderAlphabetNav(questionsToShow = null) {
      const nav = document.getElementById('alphabetNav');
      nav.innerHTML = '';
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');

      // Normalize questions input
      if (!Array.isArray(questionsToShow)) {
        questionsToShow = tabMap[activeTab] || [];
      }

      const filter = document.getElementById('searchBox').value.trim().toLowerCase();
      if (filter) {
        questionsToShow = questionsToShow.filter(q => q.q && q.q.toLowerCase().includes(filter));
      }

      // Find which letters have questions
      const availableLetters = new Set();
      questionsToShow.forEach(q => {
        if (q.q && q.q.length > 0) {
          availableLetters.add(q.q[0].toUpperCase());
        }
      });

      // Add scroll-to-top button at the top
      const scrollTopBtn = document.createElement('button');
      scrollTopBtn.className = 'alphabet-nav-btn';
      scrollTopBtn.innerHTML = '&#x2191;'; // Up arrow
      scrollTopBtn.title = 'Scroll to top';
      scrollTopBtn.style.marginBottom = '0.5em';
      scrollTopBtn.onclick = function () {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };
      nav.appendChild(scrollTopBtn);

      // Render available letters
      letters.forEach(letter => {
        if (availableLetters.has(letter)) {
          const btn = document.createElement('button');
          btn.className = 'alphabet-nav-btn';
          btn.textContent = letter;
          btn.onclick = function () { scrollToLetter(letter); };
          nav.appendChild(btn);
        }
      });

      // Add scroll-to-bottom button at the bottom
      const scrollBottomBtn = document.createElement('button');
      scrollBottomBtn.className = 'alphabet-nav-btn';
      scrollBottomBtn.innerHTML = '&#x2193;'; // Down arrow
      scrollBottomBtn.title = 'Scroll to bottom';
      scrollBottomBtn.style.marginTop = '0.5em';
      scrollBottomBtn.onclick = function () {
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
      };
      nav.appendChild(scrollBottomBtn);
    }

    function scrollToLetter(letter) {
      const items = document.querySelectorAll('.question-item');
      for (let item of items) {
        const questionBtn = item.querySelector('.question-btn');
        const text = questionBtn.textContent;
        // Skip the number prefix
        const questionText = text.replace(/^\d+\.\s*/, '');
        if (questionText && questionText[0].toUpperCase() === letter) {
          item.scrollIntoView({ behavior: 'smooth', block: 'start' });
          break;
        }
      }
    }

    function renderKeyboard() {
      const row = document.getElementById('keyboardRow');
      row.innerHTML = '';
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
      letters.forEach(letter => {
        const btn = document.createElement('button');
        btn.className = 'keyboard-btn';
        btn.textContent = letter;
        btn.onclick = function () {
          const input = document.getElementById('searchBox');
          const start = input.selectionStart;
          const end = input.selectionEnd;
          const value = input.value;
          input.value = value.slice(0, start) + letter + value.slice(end);
          input.focus();
          input.selectionStart = input.selectionEnd = start + 1;
          input.dispatchEvent(new Event('input'));
        };
        row.appendChild(btn);
      });
      // Space button
      const spaceBtn = document.createElement('button');
      spaceBtn.className = 'keyboard-btn space';
      spaceBtn.textContent = 'Space';
      spaceBtn.onclick = function () {
        const input = document.getElementById('searchBox');
        const start = input.selectionStart;
        const end = input.selectionEnd;
        const value = input.value;
        input.value = value.slice(0, start) + ' ' + value.slice(end);
        input.focus();
        input.selectionStart = input.selectionEnd = start + 1;
        input.dispatchEvent(new Event('input'));
      };
      row.appendChild(spaceBtn);
      // Delete button
      const deleteBtn = document.createElement('button');
      deleteBtn.className = 'keyboard-btn delete';
      deleteBtn.textContent = '⌫'; // Backspace symbol (explicit glyph)
      deleteBtn.onclick = function () {
        const input = document.getElementById('searchBox');
        const start = input.selectionStart;
        const end = input.selectionEnd;
        const value = input.value;
        if (start === end && start > 0) {
          input.value = value.slice(0, start - 1) + value.slice(end);
          input.selectionStart = input.selectionEnd = start - 1;
        } else if (start !== end) {
          input.value = value.slice(0, start) + value.slice(end);
          input.selectionStart = input.selectionEnd = start;
        }
        input.focus();
        input.dispatchEvent(new Event('input'));
      };
      row.appendChild(deleteBtn);
    }

    function createQuestionItem(qObj, idx) {
      const li = document.createElement('li');
      li.className = 'question-item';

      // Store priority as data attribute for filtering
      if (qObj.priority) {
        li.setAttribute('data-priority', qObj.priority);
      }

      const btn = document.createElement('button');
      btn.className = 'question-btn';
      btn.style.display = 'flex';
      btn.style.justifyContent = 'space-between';
      btn.style.alignItems = 'center';

      // Question text with optional tab badge
      const questionText = document.createElement('span');
      questionText.style.display = 'flex';
      questionText.style.alignItems = 'center';
      questionText.style.gap = '0.5em';

      const questionTextContent = document.createElement('span');
      questionTextContent.textContent = (idx + 1) + '. ' + (qObj.q || qObj.question || '');
      questionText.appendChild(questionTextContent);

      // Add tab badge if in global search mode
      if (isGlobalSearch && qObj.sourceTabName) {
        const tabBadge = document.createElement('span');
        tabBadge.style.fontSize = '0.7em';
        tabBadge.style.padding = '0.2em 0.5em';
        tabBadge.style.background = '#e3f2fd';
        tabBadge.style.color = '#0077cc';
        tabBadge.style.borderRadius = '3px';
        tabBadge.style.fontWeight = 'normal';
        tabBadge.style.whiteSpace = 'nowrap';
        tabBadge.textContent = qObj.sourceTabName;
        questionText.appendChild(tabBadge);
      }

      // Priority badge
      const priorityBadge = document.createElement('span');
      priorityBadge.style.marginLeft = '0.5em';
      priorityBadge.style.fontSize = '1em';
      priorityBadge.style.fontWeight = 'bold';
      priorityBadge.style.flexShrink = '0';
      priorityBadge.style.width = '1em';
      priorityBadge.style.height = '1em';
      priorityBadge.style.display = 'inline-flex';
      priorityBadge.style.alignItems = 'center';
      priorityBadge.style.justifyContent = 'center';
      priorityBadge.style.lineHeight = '1';

      if (qObj.priority === 'high') {
        priorityBadge.innerHTML = '&#x25B2;'; // ▲
        priorityBadge.style.color = '#ffb3b3';
        priorityBadge.title = 'High priority';
      } else if (qObj.priority === 'medium') {
        priorityBadge.innerHTML = '&#x25A0;'; // ■
        priorityBadge.style.color = '#ffe066';
        priorityBadge.title = 'Medium priority';
      } else if (qObj.priority === 'low') {
        priorityBadge.innerHTML = '&#x25BC;'; // ▼
        priorityBadge.style.color = '#d9d9d9';
        priorityBadge.title = 'Low priority';
      }

      btn.appendChild(questionText);
      if (qObj.priority) {
        btn.appendChild(priorityBadge);
      }

      // Create spoiler element BEFORE onclick handler
      const spoiler = document.createElement('div');
      spoiler.className = 'spoiler';
      spoiler.style.display = 'none'; // Explicitly set initial state

      btn.setAttribute('aria-expanded', 'false');
      btn.onclick = function (e) {
        const isCurrentlyVisible = spoiler.style.display === 'block';
        if (isCurrentlyVisible) {
          spoiler.style.display = 'none';
          btn.setAttribute('aria-expanded', 'false');
        } else {
          spoiler.style.display = 'block';
          btn.setAttribute('aria-expanded', 'true');
          // Lazy-highlight code blocks inside spoiler (do once)
          if (typeof Prism !== 'undefined' && !spoiler.dataset.highlighted) {
            Prism.highlightAllUnder(spoiler);
            spoiler.dataset.highlighted = '1';
          }
        }
        e.stopPropagation(); // Prevent event bubbling
      };

      // Helper function to detect language and apply syntax highlighting
      function highlightCode(code, tabId) {
        // Detect language based on current tab
        let language = 'java'; // default
        if (tabId && (tabId.includes('JS') || tabId === 'tabJSTheory' || tabId === 'tabJSPractice')) {
          language = 'javascript';
        } else if (tabId && (tabId.includes('TS') || tabId === 'tabTSTheory' || tabId === 'tabTSPractice')) {
          language = 'typescript';
        }

        // Escape HTML to prevent XSS
        const escapedCode = code
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#039;');

        return `<pre><code class="language-${language}">${escapedCode}</code></pre>`;
      }

      // Format text with proper bullet/numbered lists (each point on its own line)
      function formatTextWithLists(text) {
        if (!text) return '';
        const lines = text.split('\n');
        const out = [];
        const bulletRe = /^\s*(•|\*|-)\s+(.*)$/;
        const numberRe = /^\s*\d+[.)]\s+(.*)$/;
        let i = 0;
        while (i < lines.length) {
          const line = lines[i];
          if (bulletRe.test(line)) {
            const items = [];
            while (i < lines.length && bulletRe.test(lines[i])) {
              items.push(lines[i].replace(bulletRe, '$2'));
              i++;
            }
            out.push('<ul>' + items.map(c => '<li>' + c + '</li>').join('') + '</ul>');
            continue;
          }
          if (numberRe.test(line)) {
            const items = [];
            while (i < lines.length && numberRe.test(lines[i])) {
              const m = lines[i].match(numberRe);
              items.push(m[1]);
              i++;
            }
            out.push('<ol>' + items.map(c => '<li>' + c + '</li>').join('') + '</ol>');
            continue;
          }
          out.push(line + '<br>');
          i++;
        }
        return out.join('');
      }

      // Support for different question formats
      if (qObj.table) {
        spoiler.innerHTML = `<b>Short Description:</b> ${qObj.short ? formatTextWithLists(qObj.short) : ''}<br><br>${qObj.table}`;
      } else if (qObj.improvements) {
        let improvementsHtml = '<ul>' + qObj.improvements.map(imp => {
          if (imp.code) {
            return `<li><b>${imp.name}:</b> ${imp.desc}<br>${highlightCode(imp.code, activeTab)}</li>`;
          }
          return `<li><b>${imp.name}:</b> ${imp.desc}</li>`;
        }).join('') + '</ul>';
        spoiler.innerHTML = `<b>Short Description:</b> ${qObj.short ? formatTextWithLists(qObj.short) : ''}<br><br><b>Top 8 Improvements:</b>${improvementsHtml}`;
      } else if (qObj.detail || qObj.code || qObj.short || qObj.example) {
        const shortFormatted = qObj.short ? formatTextWithLists(qObj.short) : '';
        const detailFormatted = qObj.detail ? formatTextWithLists(qObj.detail) : '';
        const exampleFormatted = qObj.example ? formatTextWithLists(qObj.example) : '';
        spoiler.innerHTML = `${qObj.short ? `<b>Short Answer:</b> ${shortFormatted}<br><br>` : ''}` +
          `${qObj.detail ? `<b>Detailed Answer:</b> ${detailFormatted}<br><br>` : ''}` +
          `${qObj.example ? `<b>Example:</b> ${exampleFormatted}<br><br>` : ''}` +
          `${qObj.code ? `<b>Illustration:</b>${highlightCode(qObj.code, activeTab)}` : ''}`;
      } else if (qObj.answer) {
        spoiler.innerHTML = `<b>Answer:</b> ${formatTextWithLists(qObj.answer)}`;
      } else {
        spoiler.innerHTML = 'No details available.';
      }

      li.appendChild(btn);
      li.appendChild(spoiler);
      return li;
    }

    window.addEventListener('DOMContentLoaded', function () {
      initTheme();
      const themeToggle = document.getElementById('themeToggle');
      if (themeToggle) {
        themeToggle.addEventListener('click', function () {
          const isDark = document.body.classList.contains('dark');
          const next = isDark ? 'light' : 'dark';
          localStorage.setItem('theme', next);
          applyTheme(next);
          if (typeof updateFilterButtonStyles === 'function') updateFilterButtonStyles();
          if (typeof updateGlobalSearchButtonStyle === 'function') updateGlobalSearchButtonStyle();
        });
      }

      document.getElementById('extraTabContent').style.display = 'none';

      // Start with Java Theory content but without showing subtabs
      showTab('tabTheory');

      renderKeyboard();

      // Search box input listener (debounced)
      const searchBox = document.getElementById('searchBox');
      searchBox.addEventListener('input', debounce(function () { renderQuestions(this.value); }, 150));

      // Show/hide keyboard based on search box focus
      const keyboardRow = document.getElementById('keyboardRow');

      searchBox.addEventListener('focus', function () {
        keyboardRow.classList.add('visible');
      });

      searchBox.addEventListener('blur', function (e) {
        // Delay hiding to allow keyboard button clicks to register
        setTimeout(() => {
          // Only hide if the search box is still not focused
          if (document.activeElement !== searchBox) {
            keyboardRow.classList.remove('visible');
          }
        }, 150);
      });

      // Keep keyboard visible when clicking keyboard buttons
      keyboardRow.addEventListener('mousedown', function (e) {
        // Prevent blur event on search box when clicking keyboard
        e.preventDefault();
      });

      // Hide keyboard when clicking outside search box or keyboard
      document.addEventListener('click', function (e) {
        const isSearchBox = e.target === searchBox;
        const isKeyboard = keyboardRow.contains(e.target);

        if (!isSearchBox && !isKeyboard) {
          keyboardRow.classList.remove('visible');
        }
      });

      // Clear search button
      const clearBtn = document.getElementById('clearSearchBtn');
      clearBtn.addEventListener('click', function () {
        searchBox.value = '';
        renderQuestions('');
        searchBox.focus();
      });

      // Global search button
      const globalSearchBtn = document.getElementById('globalSearchBtn');
      function updateGlobalSearchButtonStyle() {
        const isDark = document.body.classList.contains('dark');
        const inactiveBg = isDark ? '#171a21' : '#fff';
        const inactiveBorder = isDark ? '#2a3142' : '#ccc';
        const inactiveColor = isDark ? '#e7eaf0' : '#222';
        const activeBg = isDark ? '#1d2431' : '#e3f2fd';
        const activeBorder = isDark ? '#5db0ff' : '#0077cc';
        const activeColor = isDark ? '#5db0ff' : '#0077cc';
        if (isGlobalSearch) {
          globalSearchBtn.style.background = activeBg;
          globalSearchBtn.style.borderColor = activeBorder;
          globalSearchBtn.style.color = activeColor;
        } else {
          globalSearchBtn.style.background = inactiveBg;
          globalSearchBtn.style.borderColor = inactiveBorder;
          globalSearchBtn.style.color = inactiveColor;
        }
      }
      globalSearchBtn.addEventListener('click', function () {
        isGlobalSearch = !isGlobalSearch; // Toggle
        updateGlobalSearchButtonStyle();
        searchBox.placeholder = isGlobalSearch ? 'Search all tabs...' : 'Search questions...';
        renderQuestions(searchBox.value);
      });

      // Tabs toggle button (mobile only)
      const tabsToggle = document.getElementById('tabsToggle');
      const tabsContainer = document.getElementById('tabsContainer');

      tabsToggle.addEventListener('click', function () {
        const isCollapsed = this.classList.contains('collapsed');

        if (isCollapsed) {
          // Expand tabs
          this.classList.remove('collapsed');
          if (tabsContainer) tabsContainer.classList.remove('collapsed');
        } else {
          // Collapse tabs
          this.classList.add('collapsed');
          if (tabsContainer) tabsContainer.classList.add('collapsed');
        }
      });

      // Main tab event listeners (Java, JS, TS, Cypress - expandable)
      document.getElementById('mainJava').addEventListener('click', () => toggleMainTab('mainJava'));
      document.getElementById('mainJS').addEventListener('click', () => toggleMainTab('mainJS'));
      document.getElementById('mainTS').addEventListener('click', () => toggleMainTab('mainTS'));
      document.getElementById('mainCypress').addEventListener('click', () => toggleMainTab('mainCypress'));
      document.getElementById('mainMisc').addEventListener('click', () => toggleMainTab('mainMisc'));

      // Subtab event listeners
      document.getElementById('tabTheory').addEventListener('click', () => showTab('tabTheory'));
      document.getElementById('tabPractice').addEventListener('click', () => showTab('tabPractice'));
      document.getElementById('tabJSTheory').addEventListener('click', () => showTab('tabJSTheory'));
      document.getElementById('tabJSPractice').addEventListener('click', () => showTab('tabJSPractice'));
      document.getElementById('tabTSTheory').addEventListener('click', () => showTab('tabTSTheory'));
      document.getElementById('tabTSPractice').addEventListener('click', () => showTab('tabTSPractice'));
      document.getElementById('tabCypressTheory').addEventListener('click', () => showTab('tabCypressTheory'));
      document.getElementById('tabCypressPractice').addEventListener('click', () => showTab('tabCypressPractice'));
      document.getElementById('tabMiscDatabases').addEventListener('click', () => showTab('tabMiscDatabases'));
      document.getElementById('tabMiscGit').addEventListener('click', () => showTab('tabMiscGit'));
      document.getElementById('tabMiscNetwork').addEventListener('click', () => showTab('tabMiscNetwork'));
      document.getElementById('tabMiscContainers').addEventListener('click', () => showTab('tabMiscContainers'));
      document.getElementById('tabMiscGeneral').addEventListener('click', () => showTab('tabMiscGeneral'));

      // Regular tab event listeners (no expansion)
      document.getElementById('tabPrinciples').addEventListener('click', () => showTab('tabPrinciples'));
      document.getElementById('tabQA').addEventListener('click', () => showTab('tabQA'));
      document.getElementById('tabAutomation').addEventListener('click', () => showTab('tabAutomation'));
      document.getElementById('tabCultural').addEventListener('click', () => showTab('tabCultural'));
      document.getElementById('tabCurrent').addEventListener('click', () => showTab('tabCurrent'));

      // Collapse all button
      const collapseBtn = document.getElementById('collapseAllBtn');
      collapseBtn.addEventListener('click', function () {
        const spoilers = document.querySelectorAll('.spoiler');
        spoilers.forEach(spoiler => {
          spoiler.style.display = 'none';
        });
        const buttons = document.querySelectorAll('.question-btn');
        buttons.forEach(btn => {
          btn.setAttribute('aria-expanded', 'false');
        });
      });

      // Priority filter buttons
      const filterHighBtn = document.getElementById('filterHighBtn');
      const filterMediumBtn = document.getElementById('filterMediumBtn');
      const filterLowBtn = document.getElementById('filterLowBtn');

      function updateFilterButtonStyles() {
        const isDark = document.body.classList.contains('dark');
        const inactiveBg = isDark ? '#171a21' : '#fff';
        const inactiveBorder = isDark ? '#2a3142' : '#ccc';
        const activeBg = isDark ? '#1d2431' : '#e3f2fd';
        const activeBorder = isDark ? '#5db0ff' : '#0077cc';

        // Reset all filter button styles
        filterHighBtn.style.background = inactiveBg;
        filterHighBtn.style.borderColor = inactiveBorder;
        filterHighBtn.style.color = '#ffb3b3';

        filterMediumBtn.style.background = inactiveBg;
        filterMediumBtn.style.borderColor = inactiveBorder;
        filterMediumBtn.style.color = '#ffe066';

        filterLowBtn.style.background = inactiveBg;
        filterLowBtn.style.borderColor = inactiveBorder;
        filterLowBtn.style.color = '#d9d9d9';

        // Highlight active filter
        if (activePriorityFilter === 'high') {
          filterHighBtn.style.background = activeBg;
          filterHighBtn.style.borderColor = activeBorder;
        } else if (activePriorityFilter === 'medium') {
          filterMediumBtn.style.background = activeBg;
          filterMediumBtn.style.borderColor = activeBorder;
        } else if (activePriorityFilter === 'low') {
          filterLowBtn.style.background = activeBg;
          filterLowBtn.style.borderColor = activeBorder;
        }
      }

      filterHighBtn.addEventListener('click', function () {
        if (activePriorityFilter === 'high') {
          activePriorityFilter = null; // Toggle off
        } else {
          activePriorityFilter = 'high';
        }
        updateFilterButtonStyles();
        renderQuestions(searchBox.value);
      });

      filterMediumBtn.addEventListener('click', function () {
        if (activePriorityFilter === 'medium') {
          activePriorityFilter = null; // Toggle off
        } else {
          activePriorityFilter = 'medium';
        }
        updateFilterButtonStyles();
        renderQuestions(searchBox.value);
      });

      filterLowBtn.addEventListener('click', function () {
        if (activePriorityFilter === 'low') {
          activePriorityFilter = null; // Toggle off
        } else {
          activePriorityFilter = 'low';
        }
        updateFilterButtonStyles();
        renderQuestions(searchBox.value);
      });
    });
  </script>


</body>

</html>